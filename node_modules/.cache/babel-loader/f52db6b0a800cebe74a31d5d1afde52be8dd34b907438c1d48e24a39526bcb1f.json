{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/guilh/Documents/GitHub/Aulas/React/myblog/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/guilh/Documents/GitHub/Aulas/React/myblog/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/guilh/Documents/GitHub/Aulas/React/myblog/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import axios from'axios';import{useParams,useNavigate}from'react-router-dom';import articles from'./article-content';import NotFound from'./NotFoundPage';import CommentsList from'../components/CommentsList';import AddCommentForm from'../components/AddCommentForm';import useUser from'../hooks/useUser';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function ArticlePage(){var _useState=useState({upvotes:0,comments:[],canUpvote:false}),_useState2=_slicedToArray(_useState,2),articleInfo=_useState2[0],setArticleInfo=_useState2[1];var canUpvote=articleInfo.canUpvote;var _useParams=useParams(),articleId=_useParams.articleId;var _useUser=useUser(),user=_useUser.user,isLoading=_useUser.isLoading;var navigate=useNavigate();useEffect(function(){var loadArticleInfo=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var token,headers,response,newArticleInfo;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.t0=user;if(!_context.t0){_context.next=5;break;}_context.next=4;return user.getIdToken();case 4:_context.t0=_context.sent;case 5:token=_context.t0;headers=token?{authToken:token}:{};_context.next=9;return axios.get(\"/api/articles/\".concat(articleId),{headers:headers});case 9:response=_context.sent;newArticleInfo=response.data;setArticleInfo(newArticleInfo);case 12:case\"end\":return _context.stop();}}},_callee);}));return function loadArticleInfo(){return _ref.apply(this,arguments);};}();if(!isLoading){loadArticleInfo();}},[user,isLoading]);var article=articles.find(function(article){return article.name===articleId;});var addUpvote=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var token,headers,response,updatedArticle;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.t0=user;if(!_context2.t0){_context2.next=5;break;}_context2.next=4;return user.getIdToken();case 4:_context2.t0=_context2.sent;case 5:token=_context2.t0;headers=token?{authToken:token}:{};_context2.next=9;return axios.put(\"/api/articles/\".concat(articleId,\"/upvote\"),null,{headers:headers});case 9:response=_context2.sent;updatedArticle=response.data;setArticleInfo(updatedArticle);case 12:case\"end\":return _context2.stop();}}},_callee2);}));return function addUpvote(){return _ref2.apply(this,arguments);};}();if(!article){return/*#__PURE__*/_jsx(NotFound,{});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{children:article.title}),/*#__PURE__*/_jsx(\"div\",{className:\"upvote-section\",children:user?/*#__PURE__*/_jsxs(_Fragment,{children:[canUpvote?/*#__PURE__*/_jsx(\"button\",{onClick:addUpvote,children:\"Upvote\"}):/*#__PURE__*/_jsx(\"div\",{children:\"Already upvoted\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"This article has \",articleInfo.upvotes,\" upvote(s)\"]})]}):/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return navigate('/login');},children:\"Log in to upvote\"})}),article.content.map(function(paragraph,i){return/*#__PURE__*/_jsx(\"p\",{children:paragraph},i);}),user?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(AddCommentForm,{articleName:articleId,onArticleUpdated:function onArticleUpdated(updatedArticle){return setArticleInfo(updatedArticle);}}),/*#__PURE__*/_jsx(CommentsList,{comments:articleInfo.comments})]}):/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return navigate('/login');},children:\"Log in to comment\"})]});}","map":{"version":3,"names":["React","useState","useEffect","axios","useParams","useNavigate","articles","NotFound","CommentsList","AddCommentForm","useUser","ArticlePage","upvotes","comments","canUpvote","articleInfo","setArticleInfo","articleId","user","isLoading","navigate","loadArticleInfo","getIdToken","token","headers","authToken","get","response","newArticleInfo","data","article","find","name","addUpvote","put","updatedArticle","title","content","map","paragraph","i"],"sources":["C:/Users/guilh/Documents/GitHub/Aulas/React/myblog/src/pages/ArticlePage.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react'\r\nimport axios from 'axios'\r\nimport { useParams, useNavigate } from 'react-router-dom'\r\nimport articles from './article-content'\r\nimport NotFound from './NotFoundPage';\r\nimport CommentsList from '../components/CommentsList';\r\nimport AddCommentForm from '../components/AddCommentForm';\r\nimport useUser from '../hooks/useUser';\r\n\r\nexport default function ArticlePage() {\r\n    const [articleInfo, setArticleInfo] = useState({ upvotes: 0, comments: [], canUpvote: false })\r\n    const { canUpvote } = articleInfo\r\n    const { articleId } = useParams();\r\n\r\n    const { user, isLoading } = useUser()\r\n    const navigate = useNavigate()\r\n\r\n    useEffect(() => {\r\n        const loadArticleInfo = async () => {\r\n            const token = user && await user.getIdToken()\r\n            const headers = token ? { authToken: token } : {}\r\n            const response = await axios.get(`/api/articles/${articleId}`, { headers })\r\n            const newArticleInfo = response.data\r\n            setArticleInfo(newArticleInfo)\r\n        }\r\n        if (!isLoading) {\r\n            loadArticleInfo()\r\n        }\r\n    }, [user, isLoading])\r\n\r\n    const article = articles.find(article => article.name === articleId)\r\n\r\n    const addUpvote = async () => {\r\n        const token = user && await user.getIdToken()\r\n        const headers = token ? { authToken: token } : {}\r\n        const response = await axios.put(`/api/articles/${articleId}/upvote`, null, { headers })\r\n        const updatedArticle = response.data\r\n        setArticleInfo(updatedArticle)\r\n    }\r\n\r\n    if (!article) {\r\n        return <NotFound />\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <h1>{article.title}</h1>\r\n            <div className='upvote-section'>\r\n                {user ?\r\n                    <>\r\n                        {canUpvote ? <button onClick={addUpvote}>Upvote</button> : <div>Already upvoted</div>}\r\n                        <p>This article has {articleInfo.upvotes} upvote(s)</p>\r\n                    </>\r\n                    :\r\n                    <button onClick={() => navigate('/login')}>Log in to upvote</button>\r\n                }\r\n            </div>\r\n            {article.content.map((paragraph, i) => (\r\n                <p key={i}>{paragraph}</p>\r\n            ))}\r\n            {user ?\r\n                <>\r\n                    <AddCommentForm articleName={articleId} onArticleUpdated={updatedArticle => setArticleInfo(updatedArticle)} />\r\n                    <CommentsList comments={articleInfo.comments} />\r\n                </>\r\n                :\r\n                <button onClick={() => navigate('/login')}>Log in to comment</button>\r\n            }\r\n        </>\r\n    )\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}